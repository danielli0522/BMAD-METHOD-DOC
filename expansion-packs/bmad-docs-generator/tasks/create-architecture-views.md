# 创建架构五视图任务 (Create Five-View Architecture Task)

## 目的 (Purpose)

基于代码库分析结果，创建系统的五视图架构分析，包括逻辑视图、开发视图、部署视图、运行视图和数据视图，为技术总览文档提供清晰的架构可视化。

## 何时使用 (When to Use)

- 代码库扫描任务完成后
- 需要为技术总览文档生成架构部分
- 系统架构发生重大变更需要更新视图

## 前置条件 (Prerequisites)

- 代码库扫描任务已完成
- 技术栈清单已生成
- 项目结构和模块依赖已分析

## 执行流程 (Process)

### 1. 逻辑视图创建 (Logical View)

**功能模块关系分析：**

[[LLM: 基于代码库分析结果，创建逻辑架构视图：

1. **一级功能模块识别**
   - API层/接口层
   - 业务逻辑层
   - 数据访问层
   - 基础设施层
   - 外部依赖层

2. **模块交互关系**
   - 模块间调用方向
   - 数据流向
   - 控制流程
   - 依赖关系

3. **典型请求流程**
   - 从入口点到响应的完整路径
   - 经过的主要组件
   - 关键的处理节点
   - 数据变换点

生成 Mermaid 逻辑架构图，要求：
- 使用统一的色彩方案
- 清晰标注模块职责
- 显示主要的数据和控制流
- 突出核心业务逻辑模块]]

**生成逻辑视图说明文档：**

```markdown
### 逻辑视图说明

**典型请求处理流程:**
1. **入口点 ({{entry_point}})**: {{处理入口请求的逻辑}}
2. **路由层 ({{routing_layer}})**: {{请求分发和路由逻辑}}
3. **业务层 ({{business_layer}})**: {{核心业务逻辑处理}}
4. **数据层 ({{data_layer}})**: {{数据访问和持久化}}

**关键依赖:**
- {{dependency_1}}: {{依赖说明}}
- {{dependency_2}}: {{依赖说明}}
```

### 2. 开发视图创建 (Development View)

**代码模块依赖分析：**

[[LLM: 基于项目结构分析，创建开发视图：

1. **模块组织结构**
   - 按功能组织的模块
   - 按技术层次组织的模块
   - 共享模块和工具模块
   - 第三方依赖模块

2. **依赖关系映射**
   - 模块间的直接依赖
   - 传递依赖关系
   - 循环依赖识别
   - 依赖层次分析

3. **代码复用模式**
   - 共享组件识别
   - 工具类和帮助函数
   - 配置和常量管理
   - 接口和抽象定义

生成 Mermaid 开发视图图，包括：
- 模块依赖方向
- 分层架构体现
- 核心模块突出显示
- 外部依赖标识]]

**生成开发视图说明文档：**

```markdown
### 开发视图说明

**目录结构分析:**
```
{{项目结构树状图}}
```

**关键模块职责:**
- **{{module_1}}**: {{模块功能和责任}}
- **{{module_2}}**: {{模块功能和责任}}

**第三方库清单:**
- {{library_1}}: {{用途说明}}
- {{library_2}}: {{用途说明}}
```

### 3. 部署视图创建 (Deployment View)

**部署拓扑设计：**

[[LLM: 基于配置文件和部署脚本分析，创建部署视图：

1. **运行环境分析**
   - 应用服务器配置
   - Web 服务器设置
   - 数据库部署方案
   - 缓存和消息队列配置

2. **网络拓扑**
   - 服务间通信方式
   - 端口和协议配置
   - 负载均衡策略
   - 网络安全设置

3. **资源分配**
   - CPU 和内存需求
   - 存储空间配置
   - 网络带宽要求
   - 扩展性考虑

生成 Mermaid 部署拓扑图，展示：
- 不同类型的节点
- 服务分布情况
- 网络连接关系
- 关键的配置参数]]

### 4. 运行视图创建 (Runtime View)

**运行时行为分析：**

[[LLM: 分析系统运行时特征，创建运行视图：

1. **进程模型**
   - 主进程和工作进程
   - 线程模型分析
   - 进程间通信方式
   - 资源共享模式

2. **并发和异步处理**
   - 并发控制机制
   - 异步任务处理
   - 队列和调度器
   - 事件驱动模式

3. **性能和扩展性**
   - 吞吐量特征
   - 响应时间模式
   - 水平扩展能力
   - 垂直扩展限制

生成 Mermaid 运行时架构图，包括：
- 进程和线程关系
- 消息队列和事件流
- 并发控制点
- 性能瓶颈识别]]

### 5. 数据视图创建 (Data View)

**数据架构分析：**

[[LLM: 基于数据库模式和数据流分析，创建数据视图：

1. **实体关系建模**
   - 核心业务实体
   - 实体间关系
   - 关键属性和约束
   - 数据完整性规则

2. **数据流分析**
   - 数据输入来源
   - 数据处理流程
   - 数据输出去向
   - 数据变换逻辑

3. **存储策略**
   - 主存储系统
   - 缓存策略
   - 数据归档方案
   - 备份和恢复机制

生成 Mermaid ER 图和数据流图，显示：
- 核心实体和关系
- 数据表结构概览
- 关键外键关系
- 数据流向和变换]]

## 视图整合和验证

### 视图一致性检查

[[LLM: 确保五个视图之间的一致性：

1. **逻辑-开发视图一致性**
   - 逻辑模块与代码模块映射正确
   - 依赖关系在两个视图中保持一致

2. **开发-部署视图一致性**
   - 代码模块的部署分布合理
   - 模块依赖与网络拓扑匹配

3. **部署-运行视图一致性**
   - 部署配置支持运行时需求
   - 资源分配与性能要求匹配

4. **数据视图与其他视图集成**
   - 数据访问模式与逻辑视图一致
   - 数据存储与部署方案匹配

验证并调整视图以确保整体一致性]]

### 架构质量评估

**评估标准：**

- [ ] **完整性**: 所有五个视图都已创建
- [ ] **准确性**: 视图反映实际的系统架构
- [ ] **清晰性**: 图表易于理解和解释
- [ ] **一致性**: 视图间没有冲突信息
- [ ] **实用性**: 支持后续文档生成需求

## 输出格式 (Output Format)

### 架构视图文档结构

```markdown
# {{项目名}} 架构五视图分析

## 1. 逻辑视图 (Logical View)
[Mermaid 逻辑架构图]
[逻辑视图详细说明]

## 2. 开发视图 (Development View)
[Mermaid 模块依赖图]
[开发视图详细说明]

## 3. 部署视图 (Deployment View)
[Mermaid 部署拓扑图]
[部署视图详细说明]

## 4. 运行视图 (Runtime View)
[Mermaid 运行时架构图]
[运行视图详细说明]

## 5. 数据视图 (Data View)
[Mermaid ER 图]
[数据视图详细说明]

## 6. 架构总结
[架构特点和关键设计决策]
```

## 最佳实践指南 (Best Practices)

### Mermaid 图表设计原则

1. **一致的样式**
   - 使用统一的颜色方案
   - 保持字体和大小一致
   - 遵循相同的布局原则

2. **适当的抽象级别**
   - 不要包含过多细节
   - 突出关键组件和关系
   - 保持图表的可读性

3. **清晰的标注**
   - 使用描述性的节点名称
   - 标注重要的连接关系
   - 添加必要的说明文字

### 文字说明编写要点

1. **准确描述**
   - 基于实际代码分析结果
   - 避免猜测和假设
   - 提供具体的技术细节

2. **逻辑清晰**
   - 按照逻辑顺序组织内容
   - 使用清晰的段落结构
   - 突出重点信息

3. **实用导向**
   - 关注对开发者有用的信息
   - 提供可操作的见解
   - 支持快速理解和上手

## 成功标准 (Success Criteria)

任务成功完成的标志：

- [ ] 所有五个架构视图都已创建
- [ ] 每个视图都有对应的 Mermaid 图表
- [ ] 每个视图都有详细的文字说明
- [ ] 视图间保持一致性
- [ ] 图表清晰可读，符合最佳实践
- [ ] 文字说明准确且有实用价值
- [ ] 整体架构分析支持技术总览文档生成

完成此任务后，应具备完整的架构视图材料来支持技术总览文档的架构部分编写。
