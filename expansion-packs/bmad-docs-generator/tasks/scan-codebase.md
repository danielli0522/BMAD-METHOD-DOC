# 代码库深度扫描任务 (Comprehensive Codebase Scanning Task)

## 目的 (Purpose)

对目标代码库进行全面、系统的深度扫描，识别技术栈、架构模式、复杂流程和关键组件，为后续的技术文档生成提供准确的基础数据。

## 何时使用 (When to Use)

- 开始新项目的技术文档生成工作流
- 需要重新分析现有系统的架构和复杂性
- 技术栈发生重大变更后需要更新文档

## 前置条件 (Prerequisites)

在执行此任务前，确保：
- 已获得目标代码库的访问权限
- 代码库已克隆到本地或可通过工具访问
- 了解项目的基本背景和业务领域

## 执行流程 (Process)

### 1. 项目基础信息收集

**收集项目元数据：**
- 项目名称和描述
- 主要编程语言
- 项目规模（文件数量、代码行数）
- 最后更新时间和活跃度
- README 文件和文档概览

### 2. 技术栈识别和分析

**语言和框架检测：**

[[LLM: 系统扫描代码库，识别以下技术组件：

1. **编程语言检测**
   - 分析文件扩展名分布
   - 识别主要和次要编程语言
   - 评估语言使用比例

2. **框架和库识别**
   - 扫描依赖文件：package.json, requirements.txt, pom.xml, Gemfile, Cargo.toml 等
   - 分析 import/include 语句
   - 识别主要框架：Web框架、数据库ORM、测试框架等

3. **基础设施组件**
   - Docker 配置文件
   - CI/CD 配置 (.github, .gitlab-ci, Jenkinsfile)
   - 云平台配置文件
   - 数据库迁移文件

4. **配置文件分析**
   - 环境配置文件
   - 应用配置文件
   - 部署配置文件

输出格式化的技术栈清单，按类别组织]]

### 3. 项目结构和架构模式分析

**目录结构分析：**

[[LLM: 分析项目的目录组织结构：

1. **高层目录结构**
   - 识别主要功能模块目录
   - 分析目录命名模式
   - 评估项目组织的合理性

2. **架构模式识别**
   - MVC/MVP/MVVM 模式
   - 微服务架构特征
   - 分层架构结构
   - 模块化程度评估

3. **代码组织模式**
   - 按功能组织 vs 按技术组织
   - 代码复用策略
   - 依赖注入使用情况

创建项目结构的可视化表示]]

### 4. 复杂流程和关键组件识别

**业务流程发现：**

[[LLM: 深度分析代码以识别复杂业务流程：

1. **入口点识别**
   - Web 路由和控制器
   - API 端点定义
   - 主要函数和类
   - 事件处理器

2. **调用链追踪**
   - 方法调用深度分析
   - 跨模块依赖关系
   - 数据库访问模式
   - 外部服务调用

3. **复杂性评估**
   - 循环复杂度高的函数
   - 深度嵌套的逻辑
   - 异步处理流程
   - 事务性操作

4. **关键业务逻辑**
   - 核心算法实现
   - 业务规则引擎
   - 数据验证逻辑
   - 权限检查机制

为每个识别的复杂流程创建初步描述]]

### 5. 数据流和存储分析

**数据架构发现：**

[[LLM: 分析项目的数据处理和存储模式：

1. **数据库设计**
   - 数据库模式文件分析
   - 实体关系识别
   - 数据库迁移历史
   - 索引和约束分析

2. **数据流模式**
   - 数据输入和输出点
   - 数据转换逻辑
   - 缓存使用模式
   - 数据持久化策略

3. **API 设计**
   - REST/GraphQL 端点
   - 请求/响应模式
   - 数据序列化方式
   - API 版本控制策略

创建数据流图和实体关系图的基础信息]]

### 6. 安全和性能关注点识别

**安全性分析：**

[[LLM: 扫描安全相关的代码模式：

1. **认证和授权**
   - 身份验证机制
   - 权限控制实现
   - 会话管理策略
   - 安全中间件使用

2. **数据保护**
   - 加密实现
   - 敏感数据处理
   - 输入验证和净化
   - SQL 注入防护

3. **性能考虑**
   - 缓存策略
   - 数据库查询优化
   - 异步处理使用
   - 资源管理模式

记录发现的安全和性能模式]]

### 7. 依赖关系映射

**模块依赖分析：**

[[LLM: 创建详细的依赖关系图：

1. **内部模块依赖**
   - 模块间调用关系
   - 循环依赖检测
   - 耦合度评估
   - 接口定义分析

2. **外部依赖分析**
   - 第三方库使用情况
   - 版本兼容性分析
   - 依赖更新风险评估
   - 安全漏洞检查

3. **运行时依赖**
   - 数据库依赖
   - 外部服务依赖
   - 配置依赖
   - 环境依赖

生成依赖关系图]]

## 输出格式 (Output Format)

### 代码库分析报告结构

```markdown
# {{项目名}} 代码库分析报告

## 1. 项目基础信息
- 项目名称: 
- 主要语言: 
- 代码规模: 
- 活跃状态: 

## 2. 技术栈清单
[详细的技术组件表格]

## 3. 架构概览
[项目结构图和架构模式描述]

## 4. 复杂流程识别
[Top 30 复杂流程列表，按重要性排序]

## 5. 数据架构
[数据库设计和数据流描述]

## 6. 关键发现
[安全、性能、架构方面的重要发现]

## 7. 依赖关系图
[内部和外部依赖的可视化]
```

## 质量检查标准 (Quality Standards)

### 分析完整性检查

- [ ] 所有主要编程语言都已识别
- [ ] 核心框架和库都已发现
- [ ] 项目结构已完整映射
- [ ] 至少识别出 15+ 个复杂流程
- [ ] 数据库设计已分析
- [ ] 依赖关系图已生成

### 准确性验证

- [ ] 技术栈信息可以在代码中验证
- [ ] 复杂流程的入口点可以定位
- [ ] 架构模式与实际代码组织一致
- [ ] 依赖关系基于实际代码调用

### 实用性评估

- [ ] 分析结果为后续文档生成提供充分信息
- [ ] 复杂性评估有助于优先级排序
- [ ] 技术栈信息支持架构文档生成
- [ ] 发现的问题点有助于问题诊断文档

## 常见陷阱和最佳实践 (Common Pitfalls & Best Practices)

### 避免的陷阱

- **表面分析**: 不要仅基于文件名和目录结构做判断
- **技术偏见**: 避免基于个人技术偏好来评估架构
- **遗漏配置**: 不要忽略隐藏的配置文件和环境设置
- **静态分析局限**: 考虑运行时动态行为

### 最佳实践

- **多角度验证**: 通过多种方法验证技术栈识别结果
- **深度优先**: 对关键模块进行深度分析而非泛泛而谈
- **业务上下文**: 结合业务逻辑理解技术实现
- **演进视角**: 考虑代码演进历史和趋势

## 成功标准 (Success Criteria)

任务成功完成的标志：

- [ ] 生成了完整的代码库分析报告
- [ ] 识别出足够数量的复杂流程用于后续分析
- [ ] 技术栈信息准确且详细
- [ ] 架构模式识别正确
- [ ] 依赖关系图清晰可读
- [ ] 分析结果经过质量检查验证

完成此任务后，应具备充分信息来生成技术总览文档和进行复杂流程分析。
