# æ•°æ®åŒæ­¥ç®¡ç†åŠŸèƒ½

## æ¦‚è¿°

æ•°æ®åŒæ­¥ç®¡ç†åŠŸèƒ½æ˜¯AI-Agile-DAPå¹³å°çš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›å®Œæ•´çš„æ•°æ®åŒæ­¥è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šç§åŒæ­¥æ¨¡å¼ã€ä»»åŠ¡è°ƒåº¦ã€å®æ—¶ç›‘æ§å’Œå¤±è´¥å¤„ç†æœºåˆ¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **å¤šç§åŒæ­¥æ¨¡å¼**: å…¨é‡åŒæ­¥ã€å¢é‡åŒæ­¥ã€å®æ—¶åŒæ­¥
- **ä»»åŠ¡è°ƒåº¦**: åŸºäºCronè¡¨è¾¾å¼çš„çµæ´»è°ƒåº¦
- **å®æ—¶ç›‘æ§**: å®æ—¶çŠ¶æ€ç›‘æ§å’Œæ€§èƒ½æŒ‡æ ‡æ”¶é›†
- **å¤±è´¥å¤„ç†**: æ™ºèƒ½é‡è¯•æœºåˆ¶å’Œé”™è¯¯æ¢å¤
- **æ•°æ®ä¸€è‡´æ€§**: æ•°æ®æ ¡éªŒå’Œå†²çªè§£å†³

### ğŸ“Š ç›‘æ§å’Œå‘Šè­¦

- **å®æ—¶ä»ªè¡¨ç›˜**: åŒæ­¥çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡å¯è§†åŒ–
- **å‘Šè­¦ç³»ç»Ÿ**: å¯é…ç½®çš„å‘Šè­¦é˜ˆå€¼å’Œé€šçŸ¥æœºåˆ¶
- **æ—¥å¿—ç®¡ç†**: å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—å’Œé”™è¯¯è¿½è¸ª
- **æ€§èƒ½åˆ†æ**: ååé‡ã€å»¶è¿Ÿã€æˆåŠŸç‡ç­‰æŒ‡æ ‡

### ğŸ”§ ç®¡ç†åŠŸèƒ½

- **ä»»åŠ¡ç®¡ç†**: åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤åŒæ­¥ä»»åŠ¡
- **çŠ¶æ€æ§åˆ¶**: å¯åŠ¨ã€æš‚åœã€æ¢å¤ã€å–æ¶ˆä»»åŠ¡
- **é…ç½®ç®¡ç†**: çµæ´»çš„æ•°æ®æºå’Œç›®æ ‡é…ç½®
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶

## æ¶æ„è®¾è®¡

### æœåŠ¡ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DataSyncServiceâ”‚    â”‚SyncSchedulerSvc â”‚    â”‚RealTimeSyncSvc  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ  â”‚    â”‚ â€¢ Cronè°ƒåº¦      â”‚    â”‚ â€¢ å¢é‡æ£€æµ‹      â”‚
â”‚ â€¢ æ‰§è¡Œç®¡ç†      â”‚    â”‚ â€¢ ä¼˜å…ˆçº§ç®¡ç†    â”‚    â”‚ â€¢ å˜æ›´æ•è·      â”‚
â”‚ â€¢ çŠ¶æ€è·Ÿè¸ª      â”‚    â”‚ â€¢ é˜Ÿåˆ—ç®¡ç†      â”‚    â”‚ â€¢ æµå¼åŒæ­¥      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚SyncMonitorServiceâ”‚
                    â”‚                 â”‚
                    â”‚ â€¢ æŒ‡æ ‡æ”¶é›†      â”‚
                    â”‚ â€¢ å‘Šè­¦æ£€æµ‹      â”‚
                    â”‚ â€¢ ä»ªè¡¨ç›˜æ•°æ®    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
æ•°æ®æº â†’ å¢é‡æ£€æµ‹ â†’ æ•°æ®è½¬æ¢ â†’ å†²çªè§£å†³ â†’ ç›®æ ‡å­˜å‚¨
   â†‘         â†“         â†“         â†“         â†“
   â””â”€â”€â”€ ç›‘æ§æœåŠ¡ â†â”€â”€ æ—¥å¿—è®°å½• â†â”€â”€ çŠ¶æ€æ›´æ–° â†â”€â”€ æ‰§è¡Œåé¦ˆ
```

## APIæ¥å£

### åŒæ­¥ä»»åŠ¡ç®¡ç†

#### åˆ›å»ºåŒæ­¥ä»»åŠ¡

```http
POST /api/sync/jobs
Content-Type: application/json

{
  "name": "é”€å”®æ•°æ®åŒæ­¥",
  "sourceConfig": {
    "type": "mysql",
    "host": "localhost",
    "port": 3306,
    "database": "sales_db",
    "table": "orders"
  },
  "targetConfig": {
    "type": "postgresql",
    "host": "localhost",
    "port": 5432,
    "database": "analytics_db",
    "table": "sales_orders"
  },
  "syncMode": "incremental",
  "schedule": "0 */15 * * * *",
  "priority": 5,
  "retryConfig": {
    "maxRetries": 3,
    "backoffStrategy": "exponential",
    "initialDelay": 1000
  }
}
```

#### è·å–ä»»åŠ¡åˆ—è¡¨

```http
GET /api/sync/jobs?status=running&limit=20&offset=0
```

#### å¯åŠ¨ä»»åŠ¡

```http
POST /api/sync/jobs/{jobId}/start
```

#### æš‚åœä»»åŠ¡

```http
POST /api/sync/jobs/{jobId}/pause
```

### å®šæ—¶ä»»åŠ¡ç®¡ç†

#### åˆ›å»ºå®šæ—¶ä»»åŠ¡

```http
POST /api/sync/scheduled-tasks
Content-Type: application/json

{
  "name": "æ¯æ—¥æ•°æ®æ¸…ç†",
  "schedule": "0 2 * * *",
  "jobType": "data_cleanup",
  "priority": 3,
  "config": {
    "retentionDays": 30,
    "tables": ["temp_data", "log_data"]
  }
}
```

#### æ‰‹åŠ¨è§¦å‘ä»»åŠ¡

```http
POST /api/sync/scheduled-tasks/{taskId}/trigger
```

### å®æ—¶åŒæ­¥ç®¡ç†

#### å¯åŠ¨å®æ—¶åŒæ­¥

```http
POST /api/sync/realtime-syncs
Content-Type: application/json

{
  "name": "ç”¨æˆ·æ•°æ®å®æ—¶åŒæ­¥",
  "sourceConfig": {
    "type": "mysql",
    "host": "localhost",
    "database": "user_db"
  },
  "targetConfig": {
    "type": "elasticsearch",
    "host": "localhost",
    "index": "users"
  },
  "syncMode": "streaming",
  "interval": 5000
}
```

### ç›‘æ§å’Œå‘Šè­¦

#### è·å–ä»ªè¡¨ç›˜æ•°æ®

```http
GET /api/sync/dashboard
```

#### è·å–ç›‘æ§æŒ‡æ ‡

```http
GET /api/sync/metrics?startTime=2024-01-01T00:00:00Z&endTime=2024-01-02T00:00:00Z
```

#### è·å–å‘Šè­¦åˆ—è¡¨

```http
GET /api/sync/alerts?limit=10
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

```bash
# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# åŒæ­¥æœåŠ¡é…ç½®
SYNC_MAX_CONCURRENT_JOBS=5
SYNC_DEFAULT_TIMEOUT=300000
SYNC_RETRY_MAX_ATTEMPTS=3

# ç›‘æ§é…ç½®
MONITOR_COLLECTION_INTERVAL=10000
MONITOR_ALERT_ERROR_RATE_THRESHOLD=5
MONITOR_ALERT_LATENCY_THRESHOLD=30000
```

### æ•°æ®æºé…ç½®

#### MySQLæ•°æ®æº

```javascript
{
  "type": "mysql",
  "host": "localhost",
  "port": 3306,
  "database": "source_db",
  "username": "user",
  "password": "password",
  "table": "source_table",
  "incrementalField": "updated_at",
  "batchSize": 1000
}
```

#### PostgreSQLæ•°æ®æº

```javascript
{
  "type": "postgresql",
  "host": "localhost",
  "port": 5432,
  "database": "source_db",
  "username": "user",
  "password": "password",
  "table": "source_table",
  "incrementalField": "updated_at",
  "batchSize": 1000
}
```

#### Elasticsearchæ•°æ®æº

```javascript
{
  "type": "elasticsearch",
  "host": "localhost",
  "port": 9200,
  "index": "source_index",
  "query": {
    "match_all": {}
  },
  "batchSize": 100
}
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬åŒæ­¥ä»»åŠ¡

```javascript
const { DataSyncService } = require('./src/services/sync/DataSyncService');

const syncService = new DataSyncService();
await syncService.initialize();

// åˆ›å»ºåŒæ­¥ä»»åŠ¡
const jobId = await syncService.createSyncJob({
  name: 'ç”¨æˆ·æ•°æ®åŒæ­¥',
  sourceConfig: {
    type: 'mysql',
    host: 'localhost',
    database: 'user_db',
    table: 'users',
  },
  targetConfig: {
    type: 'postgresql',
    host: 'localhost',
    database: 'analytics_db',
    table: 'user_analytics',
  },
  syncMode: 'incremental',
  schedule: '0 */30 * * * *', // æ¯30åˆ†é’Ÿæ‰§è¡Œ
});

// å¯åŠ¨åŒæ­¥
await syncService.startSync(jobId);

// è·å–çŠ¶æ€
const status = await syncService.getSyncStatus(jobId);
console.log('åŒæ­¥çŠ¶æ€:', status);
```

### å®æ—¶åŒæ­¥

```javascript
const { RealTimeSyncService } = require('./src/services/sync/RealTimeSyncService');

const realtimeService = new RealTimeSyncService();
await realtimeService.initialize();

// å¯åŠ¨å®æ—¶åŒæ­¥
const syncId = await realtimeService.startRealtimeSync({
  name: 'è®¢å•å®æ—¶åŒæ­¥',
  sourceConfig: {
    type: 'mysql',
    host: 'localhost',
    database: 'order_db',
  },
  targetConfig: {
    type: 'elasticsearch',
    host: 'localhost',
    index: 'orders',
  },
  syncMode: 'streaming',
});

// ç›‘å¬åŒæ­¥äº‹ä»¶
realtimeService.on('dataChangeProcessed', (syncId, change) => {
  console.log('æ•°æ®å˜æ›´å·²å¤„ç†:', change);
});
```

### ç›‘æ§å’Œå‘Šè­¦

```javascript
const { SyncMonitorService } = require('./src/services/sync/SyncMonitorService');

const monitorService = new SyncMonitorService();
await monitorService.initialize();

// è®¾ç½®å‘Šè­¦é˜ˆå€¼
monitorService.setAlertThresholds({
  errorRate: 5,
  latency: 30000,
  queueLength: 100,
});

// ç›‘å¬å‘Šè­¦äº‹ä»¶
monitorService.on('alert', alert => {
  console.log('æ”¶åˆ°å‘Šè­¦:', alert.message);
  // å‘é€é€šçŸ¥é‚®ä»¶æˆ–çŸ­ä¿¡
});

// è·å–ä»ªè¡¨ç›˜æ•°æ®
const dashboard = await monitorService.getDashboardData();
console.log('ä»ªè¡¨ç›˜æ•°æ®:', dashboard);
```

## éƒ¨ç½²è¯´æ˜

### ä¾èµ–å®‰è£…

```bash
# å®‰è£…Node.jsä¾èµ–
npm install

# å®‰è£…Redis
# Ubuntu/Debian
sudo apt-get install redis-server

# macOS
brew install redis

# å¯åŠ¨RedisæœåŠ¡
redis-server
```

### æœåŠ¡å¯åŠ¨

```bash
# å¼€å‘ç¯å¢ƒ
npm run dev

# ç”Ÿäº§ç¯å¢ƒ
npm start
```

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t ai-agile-dap .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name ai-agile-dap \
  -p 3000:3000 \
  -e REDIS_HOST=redis \
  --link redis:redis \
  ai-agile-dap
```

## æµ‹è¯•

### å•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm test -- --testNamePattern="DataSyncService"

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### é›†æˆæµ‹è¯•

```bash
# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
npm run test:e2e
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Redisè¿æ¥å¤±è´¥**
   - æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦å¯åŠ¨
   - éªŒè¯è¿æ¥é…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

2. **åŒæ­¥ä»»åŠ¡å¤±è´¥**
   - æ£€æŸ¥æ•°æ®æºè¿æ¥é…ç½®
   - éªŒè¯è¡¨ç»“æ„å’Œå­—æ®µæ˜ å°„
   - æŸ¥çœ‹é”™è¯¯æ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯

3. **æ€§èƒ½é—®é¢˜**
   - è°ƒæ•´æ‰¹å¤„ç†å¤§å°
   - ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
   - å¢åŠ å¹¶å‘ä»»åŠ¡æ•°é‡

4. **å†…å­˜ä½¿ç”¨è¿‡é«˜**
   - å‡å°‘å¹¶å‘ä»»åŠ¡æ•°é‡
   - ä¼˜åŒ–æ•°æ®å¤„ç†é€»è¾‘
   - å¢åŠ ç³»ç»Ÿå†…å­˜

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æŸ¥çœ‹åŒæ­¥ä»»åŠ¡æ—¥å¿—
tail -f logs/sync.log
```

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: https://github.com/yourusername/ai-agile-dap
- é—®é¢˜åé¦ˆ: https://github.com/yourusername/ai-agile-dap/issues
- é‚®ç®±: support@ai-agile-dap.com
